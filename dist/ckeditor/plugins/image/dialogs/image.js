CKEDITOR.dialog.add("image",function(){var b;return{onLoad:function(){var a=CKEDITOR.dialog.getCurrent();a.disableButton("ok");a.getButton("ok").getElement().addClass("disabled")},title:"Edit Image",minWidth:310,minHeight:100,contents:[{id:"info",elements:[{type:"html",label:"Upload",html:'<form id="upload"><input type="file" name="attachment" id="attachment"/></form>',onLoad:function(){var a=document.getElementById("attachment");a.onchange=function(){var d=a.files[0],c=new FileReader;d&&(c.onload=
function(){var a=CKEDITOR.dialog.getCurrent();a.enableButton("ok");a.getButton("ok").getElement().removeClass("disabled");b=c.result},c.readAsDataURL(d))}},onShow:function(){document.getElementById("upload").reset()},setup:function(a){b=a.data.url},commit:function(a){a.setData("url",b)}}]}]}});